# ==========================================================================================================
# Aria2 Advanced Configuration (standalone use, not enforced daemon mode)
# References:
#  - https://man.archlinux.org/man/aria2c.1#OPTIONS
#  - https://man.archlinux.org/man/aria2c.1#Console_Readout
#  - https://man.archlinux.org/man/aria2c.1#on
# ==========================================================================================================


# ==========================================================================================================
# BASIC SETUP
# ----------------------------------------------------------------------------------------------------------
# Optional: Run aria2c as a daemon (can be managed externally like systemd, launchctl, or scripts).
#daemon=true

# Directory where all downloaded files should be saved.
dir=${HOME}/Downloads/aria2/dow

# Log file storage (should exist or be writable).
log=${HOME}/.local/share/aria2/aria2.log

# Logging verbosity:
#   info  = recommended for interactive usage
#   debug = extremely verbose diagnostics
log-level=error
# ==========================================================================================================


# ==========================================================================================================
# DOWNLOAD & SESSION MANAGEMENT
# ----------------------------------------------------------------------------------------------------------
# Resume partial downloads (same behavior as wget -c).
continue=true

# Do not create name.1, name.2 automatically â€” keep original filename.
auto-file-renaming=false

# Allow overwriting without asking.
allow-overwrite=true
conditional-get=true

# Save state to restore unfinished downloads later.
save-session=${HOME}/.local/share/aria2/session.txt

# Save session every few seconds to prevent loss (lower = safer).
save-session-interval=5

# Save even completed tasks (keeps completed history).
force-save=true

# Provide batch download queue via file (optional). Can contain URL plus extra options.
#input-file=${HOME}/Downloads/aria2/queue.txt

# Save cookies for authenticated access and resuming protected downloads.
save-cookies=${HOME}/.cache/aira2c_cookies.txt

# Load cookies from file on startup.
load-cookies=${HOME}/.cache/firefox_cookies.txt

# Fully flush data to disk more aggressively (helps SSD/HDD safety)
# Pre-allocation mode:
#   none   = good for slow disks, avoids fragmentation on SSD
#   falloc = fastest allocation on modern filesystems
#file-allocation=none
file-allocation=falloc
async-dns=true

# Write to disk more frequently to avoid data loss on crash (default too high)
auto-save-interval=10
# ==========================================================================================================


# ==========================================================================================================
# PERFORMANCE & NETWORK TUNING
# ----------------------------------------------------------------------------------------------------------
# Max number of active downloads at once.
max-concurrent-downloads=16

# Max TCP connections to the same server per file.
max-connection-per-server=16

# Maximum number of download segments for each file.
split=16

# Do not split small files below this threshold.
min-split-size=10M

# Memory cache to reduce disk writes.
disk-cache=150M

# Keep file timestamp based on server info.
remote-time=true

# Speed limits (disabled by default):
#max-overall-download-limit=0
#max-overall-upload-limit=10M
# ==========================================================================================================


# ==========================================================================================================
# BITTORRENT OPTIONS
# ----------------------------------------------------------------------------------------------------------
# Stop seeding immediately after finishing.
seed-time=0
seed-ratio=0.0

# Retry faster
bt-tracker-connect-timeout=5
bt-tracker-timeout=10

# Expand swarm to find more peers
bt-tracker-interval=600
bt-min-crypto-level=arc4

# Local peer discovery within LAN (useful for local trackers).
bt-enable-lpd=true

# Enable listening for incoming connections (required for seeding).
follow-torrent=true
listen-port=51413

# Enable DHT and Peer Exchange for trackerless torrents.
enable-dht=true
dht-listen-port=6966
enable-peer-exchange=true

# Disable IPv6 to avoid connectivity issues on some networks.
disable-ipv6=true

# Accept unverified torrents and seeds (use with caution)
bt-hash-check-seed=true
bt-seed-unverified=true
bt-save-metadata=false

# Maximum number of peers connected per torrent.
bt-max-peers=100
#bt-request-peer-speed-limit=100K  # Increase peer discovery if slow

# Remove temporary .!aria2 files for unselected torrent items.
#bt-remove-unselected-file=true
#remove-control-file=true

# Optional: Force encrypted peers only (reduces throttling risk).
#bt-force-encryption=true

# Spoof a known BitTorrent client for compatibility.
# aria2 already handles BT peer IDs correctly when `peer-id-prefix` is set.
peer-agent=qBittorrent

# Spoof a known BitTorrent client ID for compatibility.
peer-id-prefix=-qB4330-
user-agent=qBittorrent/4.3.3
#user-agent="youMom"

# Public tracker list (enable and insert trackers if needed):
# bt-tracker=\
# udp://tracker.opentrackr.org:1337/announce,...
# ==========================================================================================================


# ==========================================================================================================
# EVENT HOOKS (execute scripts on torrent lifecycle events)
# ----------------------------------------------------------------------------------------------------------
# Example: Run a script after download completes (before torrent seeding would begin).
# on-bt-download-complete=/Users/pritam/.config/aria2/script/

# on-download-start=/Users/pritam/.config/aria2/script/on_start.sh
# on-download-error=/Users/pritam/.config/aria2/script/on_error.sh
# on-download-pause=/Users/pritam/.config/aria2/script/on_pause.sh

# Run script on ANY completed download.
on-download-complete=/Users/pritam/.config/aria2/script/main_script.sh
# ==========================================================================================================


# ==========================================================================================================
# RPC INTERFACE (control aria2 from GUIs like AriaNg)
# ----------------------------------------------------------------------------------------------------------
#enable-rpc=true
#rpc-listen-all=true

# Use a secure unique token if enabling RPC.
#rpc-secret=${ARIA2C_SESSION_TOKEN}

# Newly added tasks start paused (useful for GUI control).
#pause=true
# ==========================================================================================================


# ==========================================================================================================
# CONSOLE READOUT (for direct, interactive aria2 invocation)
# ----------------------------------------------------------------------------------------------------------
# Status refresh frequency (0 = continuous).
summary-interval=0

# Use human-friendly sizes (MiB, GiB, etc.).
human-readable=true

# Print detailed completion displays.
download-result=full
#download-result=hide
# ==========================================================================================================


# ==========================================================================================================
# HTTP/HTTPS BEHAVIOR AND COMPATIBILITY
# ----------------------------------------------------------------------------------------------------------
# Custom user-agent to avoid blocks on browsers-only sites.
header=User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
header=Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
header=Accept-Language: en-us,en;q=0.5
header=Sec-Fetch-Mode: navigate

# Show fewer messages on console.
console-log-level=warn

# Use .netrc file for authentication.
no-netrc=false

# Enable gzip compression and HTTPS certificate verification.
http-accept-gzip=true
check-certificate=true

# Allow chunked transfer downloads (speeds up streaming downloads)
enable-http-pipelining=true
# ==========================================================================================================
