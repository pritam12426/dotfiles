# ==========================================================================================================
# Aria2 Advanced Configuration (for daemon use with launchctl on macOS)
# References:
#  - https://man.archlinux.org/man/aria2c.1#OPTIONS
#  - https://man.archlinux.org/man/aria2c.1#Console_Readout
#  - https://man.archlinux.org/man/aria2c.1#on
# ==========================================================================================================


# ==========================================================================================================
# BASIC SETUP
# ----------------------------------------------------------------------------------------------------------
# Run aria2 as a daemon (controlled externally, e.g. launchctl). If managed automatically, keep disabled.
#daemon=true

# Default directory where all downloads will be saved.
dir=/Users/pritam/Downloads/aria2/dow

# Log file location (use a directory with write permission).
log=/tmp/com.user.aria2/aria2c-server.log

# Logging level:
#   error = recommended for background usage (quiet and useful)
#   info  = detailed console logs
#   debug = extremely verbose
log-level=error
# ==========================================================================================================


# ==========================================================================================================
# DOWNLOAD & SESSION MANAGEMENT
# ----------------------------------------------------------------------------------------------------------
# Continue partially downloaded files (equivalent to `wget -c`).
continue=true

# Avoid renaming files automatically (e.g., filename.1, filename.2).
auto-file-renaming=false

# Permit overwriting existing files automatically.
allow-overwrite=true
conditional-get=true

# Store/reload download queue between restarts.
save-session=/tmp/com.user.aria2/aria2c-session.txt

# Save session frequently (in seconds). Low value protects against crashes.
save-session-interval=5

# Save completed downloads as well (preserves seeding metadata and history).
force-save=true

# Read links/torrents from a queue file on startup.
#   Note: Each entry can include aria2 options if separated by space or tab.
#input-file=/Users/pritam/Downloads/aria2/queue.txt

# Cookie storage (useful for authenticated downloads).
save-cookies=/Users/pritam/.cache/aira2c_cookies.txt

# Load cookies from file on startup.
load-cookies=/Users/pritam/.cache/firefox_cookies.txt

# Fully flush data to disk more aggressively (helps SSD/HDD safety)
# Pre-allocation mode:
#   none   = good for slow disks, avoids fragmentation on SSD
#   falloc = fastest allocation on modern filesystems
#file-allocation=none
file-allocation=falloc
async-dns=true

# Write to disk more frequently to avoid data loss on crash (default too high)
auto-save-interval=10
# ==========================================================================================================


# ==========================================================================================================
# PERFORMANCE & NETWORK TUNING
# ----------------------------------------------------------------------------------------------------------
# Max simultaneous downloads running at once.
max-concurrent-downloads=16

# Max connections per server for a single file.
max-connection-per-server=16

# Max number of segments per file (works with above option).
split=16

# Minimum file size threshold for splitting (avoid wasting splits).
min-split-size=10M

# Cache downloaded chunks in memory to reduce disk activity.
disk-cache=150M

# Preserve server timestamps (good for resume and syncing).
remote-time=true

# Speed limits (0 = unlimited). Uncomment if needed.
#max-overall-download-limit=0
#max-overall-upload-limit=10M
# ==========================================================================================================


# ==========================================================================================================
# BITTORRENT OPTIONS
# ----------------------------------------------------------------------------------------------------------
# Stop seeding immediately after download completes.
seed-time=0
seed-ratio=0.0

# Retry faster
bt-tracker-connect-timeout=5
bt-tracker-timeout=10

# Expand swarm to find more peers
bt-tracker-interval=600
bt-min-crypto-level=arc4

# Local peer discovery (LAN torrents only).
bt-enable-lpd=true

# Enable listening for incoming connections (required for seeding).
follow-torrent=true
listen-port=51413

# Enable DHT and Peer Exchange for trackerless torrents.
enable-dht=true
dht-listen-port=6966
enable-peer-exchange=true

# Disable IPv6 to avoid connectivity issues on some networks.
disable-ipv6=true

# Accept unverified torrents and seeds (use with caution)
bt-hash-check-seed=true
bt-seed-unverified=true
bt-save-metadata=false

# Max number of peers per torrent (helps reduce connection load).
bt-max-peers=100

# Delete .!aria2 temp files for unselected files in a torrent.
#bt-remove-unselected-file=true
#remove-control-file=true

# Spoof a known BitTorrent client for compatibility.
# aria2 already handles BT peer IDs correctly when `peer-id-prefix` is set.
peer-agent=qBittorrent

# Spoof a known BitTorrent client ID for compatibility.
peer-id-prefix=-qB4330-
user-agent=qBittorrent/4.3.3
#user-agent="youMom"

# Tracker list support (for public torrents).
# Uncomment and fill if using public tracker aggregation scripts.
#bt-tracker=\
# udp://tracker.opentrackr.org:1337/announce,...
# ==========================================================================================================


# ==========================================================================================================
# EVENT HOOKS (execute scripts on torrent lifecycle events)
# ----------------------------------------------------------------------------------------------------------
# Example: Run a script after download completes (before torrent seeding would begin).
# on-bt-download-complete=/Users/pritam/.config/aria2/script/

# on-download-start=/Users/pritam/.config/aria2/script/on_start.sh
# on-download-error=/Users/pritam/.config/aria2/script/on_error.sh
# on-download-pause=/Users/pritam/.config/aria2/script/on_pause.sh

# Run script on ANY completed download.
on-download-complete=/Users/pritam/.config/aria2/script/main_script.sh
# ==========================================================================================================


# ==========================================================================================================
# RPC INTERFACE (For usage with AriaNg, web UI, remote control, etc.)
# ----------------------------------------------------------------------------------------------------------
enable-rpc=true
rpc-listen-all=true
rpc-allow-origin-all=true

# IMPORTANT: Always protect RPC with a unique secret!
rpc-secret=8adabed3-e9db-4ef4-acb3-ba56af3b6c4f

# Newly added downloads will be paused. Start them via GUI or script.
pause=true
# ==========================================================================================================


# ==========================================================================================================
# CONSOLE READOUT (Useful when not in daemon mode)
# ----------------------------------------------------------------------------------------------------------
# Update time interval in seconds (0 = continuous update).
summary-interval=0

# Use human-readable text output (MiB, GiB, etc.).
human-readable=true

# Show summary type after a download completes.
download-result=hide
# ==========================================================================================================


# ==========================================================================================================
# HTTP / HTTPS COMPATIBILITY OPTIMIZATIONS
# ----------------------------------------------------------------------------------------------------------
# Custom User-Agent for sites that block aria2 by default.
header=User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
header=Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
header=Accept-Language: en-us,en;q=0.5
header=Sec-Fetch-Mode: navigate

# Console log level when running interactively.
console-log-level=warn

# HTTPS + compressed transfer support.
http-accept-gzip=true
check-certificate=true

# Allow chunked transfer downloads (speeds up streaming downloads)
enable-http-pipelining=true
# ==========================================================================================================
